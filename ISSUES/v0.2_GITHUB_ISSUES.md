# v0.2 Enhanced Context & Memory - GitHub Issues

This document contains atomic GitHub issues for v0.2, broken down into single-developer, single-session tasks.

## Issue Template

Each issue follows this format:
- **Title**: Clear, actionable title
- **Labels**: `enhancement`, `v0.2`, and any relevant component labels
- **Description**: Specific scope and requirements
- **Acceptance Criteria**: Clear completion criteria
- **Estimated Size**: Small/Medium/Large

---

## 1. Add Shell History Context Collection

**Title**: `feat(context): Add shell history context collection`

**Labels**: `enhancement`, `v0.2`, `context`

**Description**: 
Add functionality to collect recent shell command history for context injection. This should include:
- Parse shell history files (bash: ~/.bash_history, zsh: ~/.zsh_history)
- Extract last N commands (configurable, default: 10)
- Filter sensitive commands (passwords, API keys)
- Handle different shell history formats

**Acceptance Criteria**:
- ✅ Can extract last 10 commands from bash history
- ✅ Can extract last 10 commands from zsh history  
- ✅ Sensitive command filtering implemented
- ✅ Configurable history length via config
- ✅ Unit tests with 90%+ coverage
- ✅ No performance degradation (>100ms)

**Estimated Size**: Medium

---

## 2. Add Shell Session Context Collection

**Title**: `feat(context): Add shell session context collection`

**Labels**: `enhancement`, `v0.2`, `context`

**Description**:
Collect current shell session context including:
- Exported environment variables (excluding sensitive ones)
- Active shell aliases
- Current shell options and settings
- Session-specific variables

**Acceptance Criteria**:
- ✅ Can collect exported environment variables
- ✅ Can collect active shell aliases
- ✅ Sensitive variable filtering (API keys, passwords)
- ✅ Configurable include/exclude patterns
- ✅ Unit tests with 90%+ coverage
- ✅ Performance <50ms

**Estimated Size**: Medium

---

## 3. Add File Listing Context Collection

**Title**: `feat(context): Add file listing context collection`

**Labels**: `enhancement`, `v0.2`, `context`

**Description**:
Add functionality to collect relevant file listings for the current directory:
- List files in current working directory
- Filter by relevance to query (when available)
- Handle large directories efficiently
- Configurable depth and file count limits

**Acceptance Criteria**:
- ✅ Can list files in current directory
- ✅ Configurable max files (default: 20)
- ✅ Relevance-based filtering
- ✅ Performance <30ms for typical directories
- ✅ Unit tests with 90%+ coverage

**Estimated Size**: Small

---

## 4. Add Detailed Git Status Context

**Title**: `feat(context): Add detailed git status context`

**Labels**: `enhancement`, `v0.2`, `context`, `git`

**Description**:
Enhance git context collection with detailed status information:
- Dirty files list with paths
- Ahead/behind commit counts
- Stash list with descriptions
- Untracked files count
- Branch protection status

**Acceptance Criteria**:
- ✅ Can detect dirty files with paths
- ✅ Can show ahead/behind counts
- ✅ Can list stashes with descriptions
- ✅ Performance <50ms
- ✅ Unit tests with 90%+ coverage
- ✅ Graceful handling of non-git directories

**Estimated Size**: Medium

---

## 5. Implement Session Memory System

**Title**: `feat(memory): Implement session memory system`

**Labels**: `enhancement`, `v0.2`, `memory`

**Description**:
Create session memory system for conversation context:
- In-memory conversation history
- Clear on new terminal session
- Configurable session timeout
- Size limits and cleanup

**Acceptance Criteria**:
- ✅ Conversation history persists during session
- ✅ Cleared on new terminal session
- ✅ Configurable size limits (default: 10 messages)
- ✅ Unit tests with 90%+ coverage
- ✅ Memory usage <1MB per session

**Estimated Size**: Medium

---

## 6. Implement Directory Memory System

**Title**: `feat(memory): Implement directory memory system`

**Labels**: `enhancement`, `v0.2`, `memory`

**Description**:
Create project-specific context storage:
- `.hai/context.json` file format
- Project-specific patterns and preferences
- Automatic discovery and loading
- Size management and cleanup

**Acceptance Criteria**:
- ✅ Creates `.hai/context.json` in project root
- ✅ Stores project-specific context
- ✅ Auto-discovers and loads context
- ✅ Configurable size limits (default: 100KB)
- ✅ Unit tests with 90%+ coverage

**Estimated Size**: Medium

---

## 7. Implement Persistent Preferences System

**Title**: `feat(memory): Implement persistent preferences system`

**Labels**: `enhancement`, `v0.2`, `memory`, `config`

**Description**:
Create user preference learning system:
- Track user command patterns
- Learn preferred command styles
- Store in global preferences file
- Apply learned patterns to new commands

**Acceptance Criteria**:
- ✅ Tracks command pattern usage
- ✅ Stores preferences in `~/.hai/preferences.json`
- ✅ Applies learned patterns to command generation
- ✅ Configurable learning rate
- ✅ Unit tests with 90%+ coverage

**Estimated Size**: Medium

---

## 8. Add Memory Management System

**Title**: `feat(memory): Add memory management system`

**Labels**: `enhancement`, `v0.2`, `memory`

**Description**:
Implement memory cleanup and size management:
- Automatic cleanup of old sessions
- Size-based cleanup triggers
- Configurable retention policies
- Memory usage monitoring

**Acceptance Criteria**:
- ✅ Automatic cleanup of sessions >24h old
- ✅ Size-based cleanup when >config limit
- ✅ Configurable retention policies
- ✅ Memory usage monitoring
- ✅ Unit tests with 90%+ coverage

**Estimated Size**: Small

---

## 9. Implement Context Relevance Detection

**Title**: `feat(context): Implement context relevance detection`

**Labels**: `enhancement`, `v0.2`, `context`, `ai`

**Description**:
Add smart context filtering based on query relevance:
- Query analysis for context needs
- Relevance scoring for context items
- Dynamic context selection
- Fallback to full context when unsure

**Acceptance Criteria**:
- ✅ Can analyze query for context needs
- ✅ Relevance scoring implemented
- ✅ Dynamic context selection working
- ✅ Unit tests with 90%+ coverage
- ✅ Performance <20ms

**Estimated Size**: Medium

---

## 10. Add Token Budget Management

**Title**: `feat(context): Add token budget management`

**Labels**: `enhancement`, `v0.2`, `context`, `llm`

**Description**:
Implement token counting and budget management:
- Token counting for all context items
- Budget allocation per context type
- Dynamic adjustment based on model limits
- Warning system for budget overruns

**Acceptance Criteria**:
- ✅ Token counting for all context types
- ✅ Budget allocation system
- ✅ Dynamic adjustment working
- ✅ Warning system implemented
- ✅ Unit tests with 90%+ coverage

**Estimated Size**: Medium

---

## 11. Add Context Summarization

**Title**: `feat(context): Add context summarization`

**Labels**: `enhancement`, `v0.2`, `context`, `ai`

**Description**:
Implement context summarization for long histories:
- Summarize long command histories
- Condense verbose context items
- Preserve key information
- Configurable summarization thresholds

**Acceptance Criteria**:
- ✅ Can summarize long command histories
- ✅ Preserves key information
- ✅ Configurable thresholds
- ✅ Unit tests with 90%+ coverage
- ✅ Performance <50ms

**Estimated Size**: Medium

---

## 12. Add Async Context Collection

**Title**: `feat(context): Add async context collection`

**Labels**: `enhancement`, `v0.2`, `context`, `performance`

**Description**:
Implement asynchronous context collection for performance:
- Async collection of all context types
- Parallel context gathering
- Timeout handling
- Fallback to synchronous when needed

**Acceptance Criteria**:
- ✅ Async collection implemented
- ✅ Parallel gathering working
- ✅ Timeout handling (default: 500ms)
- ✅ Fallback to sync mode
- ✅ Unit tests with 90%+ coverage
- ✅ Performance improvement measured

**Estimated Size**: Medium

---

## 13. Add Context Caching

**Title**: `feat(context): Add context caching`

**Labels**: `enhancement`, `v0.2`, `context`, `performance`

**Description**:
Implement context caching for performance optimization:
- Cache context between invocations
- Invalidation on relevant changes
- Configurable cache TTL
- Cache size management

**Acceptance Criteria**:
- ✅ Context caching implemented
- ✅ Invalidation on changes
- ✅ Configurable TTL (default: 30s)
- ✅ Cache size management
- ✅ Unit tests with 90%+ coverage
- ✅ Performance improvement measured

**Estimated Size**: Small

---

## 14. Update Configuration System for v0.2

**Title**: `feat(config): Update configuration system for v0.2`

**Labels**: `enhancement`, `v0.2`, `config`

**Description**:
Add new configuration options for v0.2 features:
- Memory size limits
- Context relevance thresholds
- History length settings
- Cache TTL settings
- Token budget configurations

**Acceptance Criteria**:
- ✅ All new config options added
- ✅ Default values set appropriately
- ✅ Config validation updated
- ✅ Documentation updated
- ✅ Unit tests with 90%+ coverage

**Estimated Size**: Small

---

## 15. Update Prompt Building for Smart Context Injection

**Title**: `feat(prompt): Update prompt building for smart context injection`

**Labels**: `enhancement`, `v0.2`, `prompt`, `llm`

**Description**:
Update prompt building system to handle new context types:
- Smart context injection logic
- Dynamic context selection
- Token-aware prompt construction
- Fallback mechanisms

**Acceptance Criteria**:
- ✅ Smart context injection working
- ✅ Dynamic selection implemented
- ✅ Token-aware construction
- ✅ Fallback mechanisms working
- ✅ Unit tests with 90%+ coverage

**Estimated Size**: Medium

---

## 16. Integration Testing for v0.2 Features

**Title**: `test: Integration testing for v0.2 features`

**Labels**: `testing`, `v0.2`, `integration`

**Description**:
Create comprehensive integration tests for v0.2:
- Test context collection workflows
- Test memory system interactions
- Test smart context injection
- Test performance requirements
- Test edge cases and error conditions

**Acceptance Criteria**:
- ✅ 20+ integration tests created
- ✅ All major workflows covered
- ✅ Performance tests included
- ✅ Edge cases tested
- ✅ 90%+ integration test coverage

**Estimated Size**: Large

---

## 17. Documentation for v0.2 Features

**Title**: `docs: Documentation for v0.2 features`

**Labels**: `documentation`, `v0.2`

**Description**:
Update documentation for v0.2 features:
- Update CONFIGURATION.md with new options
- Update USAGE.md with new features
- Add examples for memory systems
- Update context collection documentation
- Add troubleshooting for new features

**Acceptance Criteria**:
- ✅ CONFIGURATION.md updated
- ✅ USAGE.md updated with examples
- ✅ Memory system documentation added
- ✅ Context collection documented
- ✅ Troubleshooting section updated

**Estimated Size**: Medium

---

## 18. Performance Optimization for v0.2

**Title**: `perf: Performance optimization for v0.2`

**Labels**: `performance`, `v0.2`

**Description**:
Optimize performance for v0.2 features:
- Profile context collection
- Optimize memory operations
- Reduce startup overhead
- Ensure no regressions from v0.1

**Acceptance Criteria**:
- ✅ Context collection <100ms total
- ✅ Memory operations <20ms
- ✅ Startup time <150ms
- ✅ No performance regressions
- ✅ Performance tests added

**Estimated Size**: Medium

---

## Issue Summary

### Total Issues: 18
- **Small**: 4 issues (Context caching, Memory management, Config update, File listing)
- **Medium**: 12 issues (Most core features)
- **Large**: 2 issues (Integration testing, Performance optimization)

### Estimated Development Time
- **Small issues**: 1-2 hours each
- **Medium issues**: 2-4 hours each  
- **Large issues**: 4-8 hours each
- **Total estimate**: ~50-70 hours

### Dependencies
- Issues 1-4 (Context collection) should be done before 9-13 (Smart injection)
- Issues 5-8 (Memory systems) can be parallel with context work
- Issue 14 (Config) depends on understanding all new features
- Issue 15 (Prompt) depends on context and memory systems
- Issues 16-18 (Testing, docs, perf) come last

### Priority Order
1. Context collection (1-4)
2. Memory systems (5-8)
3. Smart injection (9-13)
4. Configuration (14)
5. Prompt updates (15)
6. Testing, docs, performance (16-18)

This breakdown ensures atomic, single-session tasks that are mutually exclusive and collectively exhaustive for v0.2 functionality.